import type { CfTypes } from '@livestore/common-cf';
export interface BlockRange {
    startBlock: number;
    endBlock: number;
    startOffset: number;
    endOffset: number;
}
export interface BlockData {
    blockId: number;
    data: Uint8Array;
}
/**
 * BlockManager handles the conversion between file operations and block-based storage
 * for the CloudflareSqlVFS. It manages fixed-size blocks stored in SQL tables.
 */
export declare class BlockManager {
    private readonly blockSize;
    constructor(blockSize?: number);
    /**
     * Calculate which blocks are needed for a given file operation
     */
    calculateBlockRange(offset: number, length: number): BlockRange;
    /**
     * Read blocks from SQL storage and return as a Map
     */
    readBlocks(sql: CfTypes.SqlStorage, filePath: string, blockIds: number[]): Map<number, Uint8Array>;
    /**
     * Write blocks to SQL storage using exec for now (prepared statements later)
     */
    writeBlocks(sql: CfTypes.SqlStorage, filePath: string, blocks: Map<number, Uint8Array>): void;
    /**
     * Delete blocks at or after the specified block ID (used for truncation)
     */
    deleteBlocksAfter(sql: CfTypes.SqlStorage, filePath: string, startBlockId: number): void;
    /**
     * Split write data into blocks, handling partial blocks at boundaries
     */
    splitIntoBlocks(data: Uint8Array, offset: number): Map<number, {
        blockId: number;
        blockOffset: number;
        data: Uint8Array;
    }>;
    /**
     * Assemble read data from blocks into a continuous buffer
     */
    assembleBlocks(blocks: Map<number, Uint8Array>, range: BlockRange, requestedLength: number): Uint8Array;
    /**
     * Handle partial block writes by reading existing block, modifying, and returning complete block
     */
    mergePartialBlock(sql: CfTypes.SqlStorage, filePath: string, blockId: number, blockOffset: number, newData: Uint8Array): Uint8Array;
    /**
     * Get statistics about block usage for a file
     */
    getBlockStats(sql: CfTypes.SqlStorage, filePath: string): {
        totalBlocks: number;
        storedBlocks: number;
        totalBytes: number;
    };
    getBlockSize(): number;
}
//# sourceMappingURL=BlockManager.d.ts.map