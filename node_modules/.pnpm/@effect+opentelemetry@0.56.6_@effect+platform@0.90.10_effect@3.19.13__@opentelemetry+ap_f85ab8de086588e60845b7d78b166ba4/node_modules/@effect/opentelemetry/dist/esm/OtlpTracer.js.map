{"version":3,"file":"OtlpTracer.js","names":["Cause","Duration","Effect","Layer","Option","Tracer","Exporter","entriesToAttributes","OtlpResource","ATTR_EXCEPTION_TYPE","ATTR_EXCEPTION_MESSAGE","ATTR_EXCEPTION_STACKTRACE","make","fnUntraced","options","otelResource","fromConfig","resource","scope","name","unsafeServiceName","exporter","label","url","headers","exportInterval","seconds","maxBatchSize","body","spans","data","resourceSpans","scopeSpans","shutdownTimeout","exportFn","span","push","makeOtlpSpan","parent","context","links","startTime","kind","makeSpan","status","_tag","attributes","Map","sampled","export","f","fiber","currentSpan","undefined","defaultContext","layer","unwrapScoped","map","setTracer","_","SpanProto","end","endTime","exit","attribute","key","value","set","event","events","addLinks","self","Object","assign","create","isSome","traceId","generateId","spanId","len","chars","result","i","Math","floor","random","length","entries","timeUnixNano","String","droppedAttributesCount","otelStatus","constOtelStatusSuccess","isInterruptedOnly","cause","code","StatusCode","Ok","message","pretty","errors","prettyErrors","firstError","Error","stringValue","boolValue","renderErrorCause","parentSpanId","SpanKind","startTimeUnixNano","endTimeUnixNano","droppedEventsCount","link","droppedLinksCount"],"sources":["../../src/OtlpTracer.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}