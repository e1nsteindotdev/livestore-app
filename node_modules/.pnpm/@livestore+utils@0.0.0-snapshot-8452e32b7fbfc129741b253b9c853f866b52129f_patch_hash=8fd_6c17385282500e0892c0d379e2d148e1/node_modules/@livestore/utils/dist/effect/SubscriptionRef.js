import { Chunk, Effect, pipe, Stream, SubscriptionRef } from 'effect';
import { dual } from 'effect/Function';
export * from 'effect/SubscriptionRef';
export const waitUntil = dual(2, (sref, predicate) => pipe(sref.changes, Stream.filter(predicate), Stream.take(1), Stream.runCollect, Effect.map(Chunk.unsafeHead)));
export const fromStream = (stream, initialValue) => Effect.gen(function* () {
    const sref = yield* SubscriptionRef.make(initialValue);
    yield* stream.pipe(Stream.tap((a) => SubscriptionRef.set(sref, a)), Stream.runDrain, Effect.forkScoped);
    return sref;
});
//# sourceMappingURL=SubscriptionRef.js.map